(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3959cdbf"],{"0a08":function(t,e,i){},"0b57":function(t,e,i){"use strict";i("3ca9")},1276:function(t,e,i){"use strict";var a=i("c65b"),n=i("e330"),s=i("d784"),o=i("825a"),c=i("7234"),r=i("1d80"),l=i("4840"),u=i("8aa5"),d=i("50c4"),m=i("577e"),v=i("dc4a"),p=i("14c3"),h=i("9f7f"),f=i("d039"),g=h.UNSUPPORTED_Y,_=4294967295,b=Math.min,C=n([].push),y=n("".slice),w=!f((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2!==i.length||"a"!==i[0]||"b"!==i[1]})),x="c"==="abbc".split(/(b)*/)[1]||4!=="test".split(/(?:)/,-1).length||2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length;s("split",(function(t,e,i){var n="0".split(void 0,0).length?function(t,i){return void 0===t&&0===i?[]:a(e,this,t,i)}:e;return[function(e,i){var s=r(this),o=c(e)?void 0:v(e,t);return o?a(o,e,s,i):a(n,m(s),e,i)},function(t,a){var s=o(this),c=m(t);if(!x){var r=i(n,s,c,a,n!==e);if(r.done)return r.value}var v=l(s,RegExp),h=s.unicode,f=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(g?"g":"y"),w=new v(g?"^(?:"+s.source+")":s,f),k=void 0===a?_:a>>>0;if(0===k)return[];if(0===c.length)return null===p(w,c)?[c]:[];var T=0,D=0,j=[];while(D<c.length){w.lastIndex=g?0:D;var A,q=p(w,g?y(c,D):c);if(null===q||(A=b(d(w.lastIndex+(g?D:0)),c.length))===T)D=u(c,D,h);else{if(C(j,y(c,T,D)),j.length===k)return j;for(var S=1;S<=q.length-1;S++)if(C(j,q[S]),j.length===k)return j;D=T=A}}return C(j,y(c,T)),j}]}),x||!w,g)},"13d5":function(t,e,i){"use strict";var a=i("23e7"),n=i("d58f").left,s=i("a640"),o=i("1212"),c=i("9adc"),r=!c&&o>79&&o<83,l=r||!s("reduce");a({target:"Array",proto:!0,forced:l},{reduce:function(t){var e=arguments.length;return n(this,t,e,e>1?arguments[1]:void 0)}})},1774:function(t,e,i){"use strict";i.r(e);var a=function(){var t,e=this,i=e._self._c;return i("div",{staticClass:"p-midautumn-detail"},[i("div",{staticClass:"u-bg",style:e.bgStyle},[i("Nav",{attrs:{poemName:(null===(t=e.poemData)||void 0===t?void 0:t.title)||""},on:{navChange:e.back}}),i("div",{staticClass:"u-main-box"},[i("transition",{attrs:{name:"fade",mode:"out-in"}},[1==e.achieve_id?i("Introduce"):e._e(),2==e.achieve_id?i("Appreciate",{on:{poem:e.poem,back:e.back}}):e._e()],1)],1)],1)])},n=[],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-midAutumn-nav"},[e("div",{staticClass:"u-title"},[e("img",{attrs:{src:"".concat(t.__imgRoot,"menu.png")}})]),t._m(0),e("div",{staticClass:"u-nav-box"},[t._l(t.navs,(function(i){return e("div",{key:i.value,staticClass:"u-nav-item",class:{active:t.achieve_id==i.value},on:{click:function(e){return t.navChange(i.value)}}},[t._v(" "+t._s(i.text)+" ")])})),e("div",{directives:[{name:"show",rawName:"v-show",value:t.poemName,expression:"poemName"}],staticClass:"u-select-poem"},[t._v("《"+t._s(t.poemName)+"》")])],2)])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-date"},[e("span",[t._v("2")]),e("span",[t._v("0")]),e("span",[t._v("2")]),e("span",[t._v("4")])])}],c=(i("14d9"),{props:{poemName:{type:String,default:""}},inject:["__imgRoot"],components:{},data:function(){return{achieve_id:1,navs:[{text:"活动介绍",value:1},{text:"诗词赏析",value:2}]}},watch:{"$route.query":{handler:function(t){t.a&&(this.achieve_id=t.a)},immediate:!0}},created:function(){},mounted:function(){},methods:{navChange:function(t){this.$emit("navChange",t),this.$router.push({query:{a:t}})}}}),r=c,l=(i("4515"),i("2877")),u=Object(l["a"])(r,s,o,!1,null,null,null),d=u.exports,m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-midAutumn-introduce"},[e("div",{staticClass:"u-content",domProps:{innerHTML:t._s(t.data)}}),t._m(0)])},v=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-tips"},[t._v("介"),e("br"),t._v("绍")])}],p=i("cc9a"),h={components:{},data:function(){return{data:""}},created:function(){},mounted:function(){var t=this;Object(p["a"])(85620).then((function(e){t.data=e}))},methods:{}},f=h,g=(i("8475"),Object(l["a"])(f,m,v,!1,null,null,null)),_=g.exports,b=(i("a4d3"),i("e01a"),function(){var t,e=this,i=e._self._c;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"c-midAutumn-appreciate"},[e.showPoem?e._e():i("div",[e.list.length||e.loading?e._e():i("div",{staticClass:"u-empty"},[e._v(" 作品收集中，侠士可按照活动介绍中参赛方式前往魔盒网站茶馆论坛处提交作品~ "),e._m(0)]),i("div",{staticClass:"u-list"},e._l(e.list,(function(t,a){return i("div",{key:a,staticClass:"u-item",style:{"background-color":e.getColorStyle(a)},on:{click:function(i){return e.poem(t,a)}}},[i("div",{staticClass:"u-left"},[i("span",{staticClass:"u-text",attrs:{title:t.title}},[e._v(" "+e._s(e.getUserAndTitle(t).length>24?e.getUserAndTitle(t).substring(0,24):e.getUserAndTitle(t))+" "),e.getUserAndTitle(t).length>24&&!e.symbolJudge(e.getUserAndTitle(t))?i("span",{staticClass:"u-more"},[e._v("...")]):e._e()])]),i("div",{staticClass:"u-right"},e._l(e.getText(t.content,1),(function(t,a){return i("span",{key:a},[a<6?i("div",[a<5?i("span",{staticClass:"u-text"},[e._v(e._s(t.length>16?t.substring(0,16):t)+" "),t.length>16&&!e.symbolJudge(t)?i("span",{staticClass:"u-more"},[e._v("...")]):e._e(),t.length<16&&!e.symbolJudge(t)?i("span",[e._v("。")]):e._e()]):e._e(),5==a?i("span",{staticClass:"u-more"},[e._v("...")]):e._e()]):e._e()])})),0)])})),0)]),i("transition",{attrs:{name:"fade",mode:"out-in"}},[e.showPoem?i("div",{staticClass:"m-poem-main"},[i("div",{staticClass:"u-back",on:{click:e.back}},[i("i",{staticClass:"el-icon-arrow-left"})]),i("div",{staticClass:"u-author-info"},[i("div",{staticClass:"u-title"},[e._v(e._s(e.poemData.title))]),i("div",{staticClass:"u-author"},[e._v(e._s(e.poemData.sub_title))]),i("div",{staticClass:"u-user"},[e._v(e._s(e.poemData.user_info.display_name))])]),i("div",{staticClass:"u-content"},e._l(e.getText(e.poemData.content,2),(function(t,a){return i("div",{key:a,staticClass:"u-desc-item",class:{warp:t.length>43},domProps:{innerHTML:e._s(t)}})})),0),i("div",{staticClass:"u-title-tips"},[e._v(" "+e._s(e.tips)+" ")])]):e._e()]),e.showPoem?i("div",{staticClass:"m-judges"},[i("div",{staticClass:"m-qrcode"},[i("img",{staticClass:"u-img",attrs:{src:"".concat(e.cdn,"design/miniprogram/midautumn/code-bg.png?123"),alt:""}}),i("img",{staticClass:"u-qrcode",attrs:{src:e.qrcode,alt:""}})]),i("div",{staticClass:"m-list"},[i("div",{staticClass:"m-tips"},[i("img",{staticClass:"u-icon",attrs:{src:"".concat(e.cdn,"design/miniprogram/midautumn/mdi_vote.svg"),alt:""}}),e._m(1)]),null!==(t=e.poemData)&&void 0!==t&&t.id&&e.judges[e.poemData.id]&&e.judges[e.poemData.id].length?[i("img",{staticClass:"u-judges",attrs:{src:"".concat(e.cdn,"design/miniprogram/midautumn/judges.png")}}),e._l(e.judges[e.poemData.id],(function(t,a){return i("div",{key:t.id,staticClass:"m-item"},[i("div",{staticClass:"m-user"},[i("img",{staticClass:"u-avatar",attrs:{src:"".concat(e.cdn,"design/miniprogram/midautumn/avatar.png")}}),i("div",{staticClass:"u-name"},[e._v(e._s("魔盒诗词大会评委".concat(a+1)))])]),i("div",{staticClass:"m-content",style:e.bgStyle},[i("span",{domProps:{innerHTML:e._s(t.description)}})])])}))]:e._e()],2)]):e._e()],1)}),C=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-item"},[e("a",{attrs:{href:"/community?category=诗词",target:"_blank"}},[t._v("快速前往 "),e("i",{staticClass:"el-icon-right"})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-tips"},[e("div",{staticClass:"u-title"},[t._v("微信扫月亮参与投票↗")]),e("div",{staticClass:"u-desc"},[t._v("有机会赢取故宫中秋好礼！")])])}],y=(i("99af"),i("4de4"),i("c740"),i("caad"),i("13d5"),i("d3b7"),i("ac1f"),i("466d"),i("5319"),i("1276"),i("159b"),i("7bd7")),w=i("41cb");function x(t){return Object(w["b"])().get("/api/next2/vote-program/program/public/latest",{params:t})}function k(t,e){return Object(w["a"])().get("/api/cms/vote/program/item/".concat(t,"/qrcode"),{params:e})}function T(){return Object(w["a"])().get("/api/cms/manage/www/block/load",{params:{slug:"mid_autumn_2024",app:"std"}}).then((function(t){return t.data.data.items}))}var D=i("65c2"),j=i("2ef0"),A={components:{},props:{},data:function(){return{poemData:null,showPoem:!1,achieve_id:null,select_id:null,list:[],tips:"",loading:!1,qrcode:"",judges:{},cdn:D["__cdn"],bgStyle:null}},watch:{"$route.query":{handler:function(t){t.a&&(this.achieve_id=t.a),t.select&&(this.select_id=t.select),this.load()},immediate:!0},select_id:{handler:function(t){},immediate:!0}},mounted:function(){this.loadJudges()},methods:{load:function(){var t=this;this.loading=!0,x().then((function(e){t.list=Object(j["shuffle"])(e.data.data.vote_items||[]),t.loading=!1,t.init()}))},loadJudges:function(){var t=this;T().then((function(e){var i=e||[];t.judges=i.filter((function(t){return t.status})).reduce((function(t,e){return t[e.remark]||(t[e.remark]=[]),t[e.remark].push(e),t}),{})}))},init:function(){var t=this,e=this.list;if(e.length>0&&this.select_id){this.showPoem=!0;var i=e.findIndex((function(e){return e.id==t.select_id}));this.poemData=e[i],this.getTipsText(this.poemData.title),this.$emit("poem",{item:this.poemData,c:i}),this.poemBg(i),k(e[i].id,{page:"pages/midautumn/poem/poem",program_id:e[i].program_id}).then((function(e){var i=D["__cdn"].replace(/\/+$/,"");t.qrcode="".concat(i).concat(e.data.data,"?123")}))}},poemBg:function(t){var e=y.color[t]?y.color[t].color:"rgba(23, 36, 58, 0.95)";this.bgStyle="background:linear-gradient(90deg, ".concat(e," 0%, rgba(175, 72, 89, 0) 100%)")},getUserAndTitle:function(t){var e;return((null===(e=t.user_info)||void 0===e?void 0:e.display_name)||"")+"︽"+t.title+"︾"},getTipsText:function(t){var e=(null===t||void 0===t?void 0:t.match(/[\u4e00-\u9fa5]/g))||[];3==e.length?this.tips=e[1]+e[2]:e.length>3?this.tips=e[2]+e[3]:this.tips=t},symbolJudge:function(t){var e=t.substring(0,16).substring(t.substring(0,16).length-1);return["！","？","。","，","︽","︾"].includes(e)},getText:function(t,e){var i=Object(j["cloneDeep"])(t),a=i.split(/\n/),n=[];return a.forEach((function(t,i){if(t){var a=/https?:\/\/[^"']*\.(?:jpg|jpeg|gif|png)/gi,s=t.match(a);s&&s.forEach((function(i){if(1==e)t=t.replace(i,"");else{var a='<img src="'.concat(i,'" alt="" />');t=t.replace(i,a)}})),n.push(t)}})),n},getColorStyle:function(t){var e=y.color;return e[t%e.length].color},poem:function(t,e){this.poemData=t,this.showPoem=!0,this.$emit("poem",{item:t,c:e}),this.poemBg(e),this.getTipsText(t.title),this.$router.push({query:{a:this.achieve_id,select:t.id}})},back:function(){this.poemData=null,this.showPoem=!1,this.select_id=null,this.$emit("back"),this.$router.push({query:{a:this.achieve_id}})}}},q=A,S=(i("0b57"),Object(l["a"])(q,b,C,!1,null,"3af6a393",null)),$=S.exports,O={components:{Nav:d,Introduce:_,Appreciate:$},data:function(){return{achieve_id:1,bgStyle:null,poemData:null,article:[],introduce:[]}},watch:{"$route.query":{handler:function(t){t.a&&(this.achieve_id=t.a,this.$nextTick((function(){var t=document.querySelector(".u-bg");t&&(t.scrollTop=0)})))},immediate:!0}},created:function(){},mounted:function(){},methods:{init:function(){},poem:function(t){var e;this.poemData=t.item;var i=null!==(e=y.color[t.c])&&void 0!==e&&e.color?"background-color:"+y.color[t.c].color+";opacity: 0.95":"";this.bgStyle=i,this.$nextTick((function(){var t=document.querySelector(".u-bg");t&&(t.scrollTop=0)}))},back:function(){this.poemData=null,this.bgStyle=null}}},P=O,N=(i("cf73"),Object(l["a"])(P,a,n,!1,null,null,null));e["default"]=N.exports},"3ca9":function(t,e,i){},4515:function(t,e,i){"use strict";i("0a08")},"527a":function(t,e,i){},"7bd7":function(t){t.exports=JSON.parse('{"color":[{"name":"黑鸢","color":"#554236"},{"name":"桑染","color":"#64363c"},{"name":"苏芳","color":"#8e354a"},{"name":"海老茶","color":"#734338"},{"name":"莓","color":"#B5495B"},{"name":"深绯","color":"#86473F"},{"name":"樱鼠","color":"#B19693"},{"name":"长春","color":"#BF6766"},{"name":"桧皮","color":"#854836"},{"name":"紫染","color":"#967249"},{"name":"生壁","color":"#7D6C46"},{"name":"鸾茶","color":"#6C6024"},{"name":"苔","color":"#838A2D"},{"name":"松叶","color":"#42602D"},{"name":"千岁绿","color":"#36563C"},{"name":"青竹","color":"#00896C"},{"name":"铁户","color":"#255359"},{"name":"御户","color":"#0C4842"},{"name":"蓝黑茶","color":"#373C38"},{"name":"杜若","color":"#622954"}]}')},8475:function(t,e,i){"use strict";i("8e75")},"8e75":function(t,e,i){},c740:function(t,e,i){"use strict";var a=i("23e7"),n=i("b727").findIndex,s=i("44d2"),o="findIndex",c=!0;o in[]&&Array(1)[o]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),s(o)},cf73:function(t,e,i){"use strict";i("527a")},d58f:function(t,e,i){"use strict";var a=i("59ed"),n=i("7b0b"),s=i("44ad"),o=i("07fa"),c=TypeError,r="Reduce of empty array with no initial value",l=function(t){return function(e,i,l,u){var d=n(e),m=s(d),v=o(d);if(a(i),0===v&&l<2)throw new c(r);var p=t?v-1:0,h=t?-1:1;if(l<2)while(1){if(p in m){u=m[p],p+=h;break}if(p+=h,t?p<0:v<=p)throw new c(r)}for(;t?p>=0:v>p;p+=h)p in m&&(u=i(u,m[p],p,d));return u}};t.exports={left:l(!1),right:l(!0)}}}]);
//# sourceMappingURL=chunk-3959cdbf.b6962819.js.map