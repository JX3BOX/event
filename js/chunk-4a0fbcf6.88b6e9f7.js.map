{"version":3,"sources":["webpack:///./src/service/topic.js","webpack:///./src/pages/blindbox/Index.vue?e3b7","webpack:///./src/pages/blindbox/Index.vue","webpack:///./src/service/pay.js","webpack:///src/pages/blindbox/Index.vue","webpack:///./src/pages/blindbox/Index.vue?a447","webpack:///./src/pages/blindbox/Index.vue?a8d6","webpack:///./node_modules/core-js/internals/array-fill.js","webpack:///./node_modules/core-js/modules/es.array.fill.js"],"names":["getTopic","topic","$cms","mute","get","params","type","all","status","render","_vm","this","_c","_self","staticClass","isLogin","_e","on","toLogin","attrs","concat","__imgRoot","class","active","allActive","_l","boxList","number","index","key","$event","change","directives","name","rawName","value","showBox","expression","replay","_v","_s","points","ref","style","animationDuration","prizeList","item","onLoadPrizeList","refreshBox","openBox","history","close","openHistory","closeHistory","historyList","i","staticRenderFns","getMyHistory","$pay","getBlindBox","id","goodLucky","data","post","KEY","inject","ID","Array","fill","map","activeList","pageSize","open","show_goods","computed","_data","raw","forEach","subtype","push","User","watch","immediate","handler","val","_this","getAsset","then","res","mounted","init","methods","_this2","title","asset","point","boxcoin","prize","prize_type","vip_asset_type","mall_goods","goods_images","luckyDrawId","includes","cloneDeep","$refs","scrollBlock","offsetWidth","_this3","setTimeout","filter","_this4","Math","floor","random","length","hasLucky","$confirm","confirmButtonText","cancelButtonText","batch","console","log","component","toObject","toAbsoluteIndex","lengthOfArrayLike","module","exports","O","argumentsLength","arguments","undefined","end","endPos","$","addToUnscopables","target","proto"],"mappings":"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","file":"js/chunk-4a0fbcf6.88b6e9f7.js","sourcesContent":["import { $cms } from \"@jx3box/jx3box-common/js/https\";\n\nfunction getTopic(topic) {\n    return $cms({ mute: true }).get(\"/api/cms/topic\", {\n        params: {\n            type: topic,\n            all: 1,\n            status: 1,\n        },\n    });\n}\n\nexport { getTopic };","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=style&index=0&id=0d6a123a&prod&lang=less&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"p-event-blindbox\"},[(!_vm.isLogin)?_c('div',{staticClass:\"m-mark\",on:{\"click\":_vm.toLogin}}):_vm._e(),_c('el-image',{staticClass:\"m-bg\",attrs:{\"src\":`${_vm.__imgRoot}bg.png`,\"fit\":\"cover\"}}),_c('div',{staticClass:\"p-event-content\"},[_c('div',{staticClass:\"m-content\"},[_c('div',{staticClass:\"m-left\"},[_c('div',{staticClass:\"logo\"},[_c('img',{attrs:{\"src\":`${_vm.__imgRoot}logo.png`,\"alt\":\"魔盒盲盒\"}})]),_c('div',{staticClass:\"m-box\",class:{ active: _vm.allActive }},[_vm._l((_vm.boxList),function(number,index){return _c('div',{key:index,class:['u-box', '', { active: number === _vm.active }],on:{\"click\":function($event){return _vm.change(number)}}},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showBox(index)),expression:\"showBox(index)\"}],key:_vm.replay + 'box' + index,class:`u-img u-img-${index + 1}`,attrs:{\"src\":`${_vm.__imgRoot}box.png`,\"alt\":\"奖品\"}})])}),_c('div',{class:['u-mark', { active: _vm.active }]})],2)]),_c('div',{staticClass:\"m-right\"},[_c('div',{staticClass:\"m-point\"},[_vm._v(_vm._s(_vm.points))]),_c('div',{staticClass:\"m-prize box\"},[_c('div',{staticClass:\"m-title\"},[_c('img',{attrs:{\"src\":`${_vm.__imgRoot}prize.png`,\"alt\":\"奖品一览\"}})]),_c('div',{staticClass:\"m-item\"},[_c('div',{ref:\"scrollBlock\",staticClass:\"m-scroll-block\",style:({ animationDuration: _vm.animationDuration })},[_vm._l((_vm.prizeList),function(item,index){return _c('img',{key:`prize${index}`,attrs:{\"src\":item},on:{\"load\":_vm.onLoadPrizeList}})}),_vm._l((_vm.prizeList),function(item,index){return _c('img',{key:`prize_end${index}`,attrs:{\"src\":item},on:{\"load\":_vm.onLoadPrizeList}})})],2)])]),_c('div',{staticClass:\"m-lottery\"},[_c('img',{staticClass:\"u-img refresh\",attrs:{\"src\":`${_vm.__imgRoot}refresh.png`,\"alt\":\"刷新盲盒\"},on:{\"click\":_vm.refreshBox}}),_c('img',{staticClass:\"u-img random\",attrs:{\"src\":`${_vm.__imgRoot}random.png`,\"alt\":\"随机开盒\"},on:{\"click\":_vm.openBox}}),_c('img',{staticClass:\"u-img open\",attrs:{\"src\":`${_vm.__imgRoot}open.png`,\"alt\":\"十连开盒\"},on:{\"click\":function($event){return _vm.openBox('all')}}}),_c('div',{staticClass:\"m-history box u-img\",class:{ history: _vm.history, close: _vm.close }},[_c('div',{staticClass:\"m-title\"},[_c('img',{attrs:{\"src\":`${_vm.__imgRoot}history.png`,\"alt\":\"开盒记录\"},on:{\"click\":_vm.openHistory}}),_c('img',{staticClass:\"u-close\",attrs:{\"src\":`${_vm.__imgRoot}close.png`,\"alt\":\"关闭\"},on:{\"click\":_vm.closeHistory}})]),_c('div',{staticClass:\"m-history-content\"},_vm._l((_vm.historyList),function(item,i){return _c('div',{key:i,staticClass:\"m-item\"},[_vm._v(\" \"+_vm._s(item)+\" \")])}),0)])])])])])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $pay } from \"@jx3box/jx3box-common/js/https\";\n\n\n// 获取中奖历史\nfunction getMyHistory(params) {\n    return $pay().get(`/lucky-draw/my/history`, { params });\n}\n\n// 获取我的中奖\nfunction getMyLucky(id, params) {\n    return $pay().get(`/lucky-draw/my/history/${id}/details`, { params });\n}\n\n// 所有抽奖列表\nfunction getLuckyList(params) {\n    return $pay().get(`/lucky-draw/public/list`, { params });\n}\n// 获取活动详情\nfunction getBlindBox(id) {\n    return $pay().get(`/lucky-draw/public/details`, { params: { id } });\n}\n\n// 抽奖\nfunction goodLucky(id, data) {\n    return $pay().post(`/lucky-draw/public/item/${id}/try-my-lucky`, data);\n}\n\n\nexport {\n    getMyHistory,\n    getBlindBox,\n    getMyLucky,\n    goodLucky,\n    getLuckyList\n};","<template>\n    <div class=\"p-event-blindbox\">\n        <!-- 判断是否登录，没有登录跳转登录 -->\n        <div class=\"m-mark\" @click=\"toLogin\" v-if=\"!isLogin\"></div>\n        <!-- 模糊背景 -->\n        <el-image :src=\"`${__imgRoot}bg.png`\" class=\"m-bg\" fit=\"cover\" />\n        <!-- 内容 -->\n        <div class=\"p-event-content\">\n            <div class=\"m-content\">\n                <!-- 左侧 -->\n                <div class=\"m-left\">\n                    <div class=\"logo\">\n                        <img :src=\"`${__imgRoot}logo.png`\" alt=\"魔盒盲盒\" />\n                    </div>\n                    <!-- 抽奖盒子 -->\n                    <div class=\"m-box\" :class=\"{ active: allActive }\">\n                        <div\n                            :class=\"['u-box', '', { active: number === active }]\"\n                            v-for=\"(number, index) in boxList\"\n                            :key=\"index\"\n                            @click=\"change(number)\"\n                        >\n                            <img\n                                :class=\"`u-img u-img-${index + 1}`\"\n                                :src=\"`${__imgRoot}box.png`\"\n                                alt=\"奖品\"\n                                :key=\"replay + 'box' + index\"\n                                v-show=\"showBox(index)\"\n                            />\n                        </div>\n                        <div :class=\"['u-mark', { active }]\"></div>\n                    </div>\n                </div>\n                <!-- 右侧 -->\n                <div class=\"m-right\">\n                    <!-- 积分现实 -->\n                    <div class=\"m-point\">{{ points }}</div>\n                    <!-- 奖品轮播 -->\n                    <div class=\"m-prize box\">\n                        <div class=\"m-title\">\n                            <img :src=\"`${__imgRoot}prize.png`\" alt=\"奖品一览\" />\n                        </div>\n                        <div class=\"m-item\">\n                            <div class=\"m-scroll-block\" ref=\"scrollBlock\" :style=\"{ animationDuration }\">\n                                <img\n                                    v-for=\"(item, index) in prizeList\"\n                                    :key=\"`prize${index}`\"\n                                    @load=\"onLoadPrizeList\"\n                                    :src=\"item\"\n                                />\n                                <img\n                                    v-for=\"(item, index) in prizeList\"\n                                    :key=\"`prize_end${index}`\"\n                                    @load=\"onLoadPrizeList\"\n                                    :src=\"item\"\n                                />\n                                <!--跑马灯效果需要展示两份图片以首尾衔接-->\n                            </div>\n                        </div>\n                    </div>\n                    <!-- 抽奖按钮 -->\n                    <div class=\"m-lottery\">\n                        <img\n                            :src=\"`${__imgRoot}refresh.png`\"\n                            class=\"u-img refresh\"\n                            @click=\"refreshBox\"\n                            alt=\"刷新盲盒\"\n                        />\n                        <img :src=\"`${__imgRoot}random.png`\" class=\"u-img random\" alt=\"随机开盒\" @click=\"openBox\" />\n                        <img :src=\"`${__imgRoot}open.png`\" class=\"u-img open\" alt=\"十连开盒\" @click=\"openBox('all')\" />\n                        <!-- 中奖记录 -->\n                        <div class=\"m-history box u-img\" :class=\"{ history, close }\">\n                            <div class=\"m-title\">\n                                <img :src=\"`${__imgRoot}history.png`\" alt=\"开盒记录\" @click=\"openHistory\" />\n                                <img :src=\"`${__imgRoot}close.png`\" class=\"u-close\" alt=\"关闭\" @click=\"closeHistory\" />\n                            </div>\n                            <div class=\"m-history-content\">\n                                <div class=\"m-item\" v-for=\"(item, i) in historyList\" :key=\"i\">\n                                    {{ item }}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <!-- <div class=\"m-goods\" :class=\"{ active: show_goods }\">\n            <div class=\"m-item\">\n                <div class=\"u-item box\" v-for=\"item in 10\" :key=\"item\"></div>\n            </div>\n            <img :src=\"`${__imgRoot}get.png`\" class=\"u-get\" alt=\"拿下\" @click=\"show_goods = false\" />\n        </div> -->\n    </div>\n</template>\n\n<script>\nconst KEY = \"blindbox\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { getTopic } from \"@/service/topic\";\nimport { getBlindBox, goodLucky, getMyHistory, getMyLucky } from \"@/service/pay\";\nimport { cloneDeep } from \"lodash\";\nexport default {\n    name: \"Index\",\n    inject: [\"__imgRoot\"],\n    data: function () {\n        return {\n            ID: 0,\n            prizeList: [],\n            points: 0,\n            index: 0,\n\n            animationDuration: \"0s\",\n            active: \"\",\n            allActive: false,\n            boxList: new Array(10).fill(1).map((item, index) => index + 1),\n            activeList: [],\n            replay: 0,\n            historyList: [],\n            status: {\n                0: \"全部\",\n                1: \"抽奖中\",\n                2: \"中奖\",\n                3: \"未中奖\",\n            },\n\n            history: false,\n            pageSize: 30,\n            close: false,\n            open: false,\n            show_goods: false,\n        };\n    },\n    computed: {\n        data: function () {\n            let _data = {};\n            this.raw.forEach((item) => {\n                if (!_data[item.subtype]) _data[item.subtype] = [];\n                _data[item.subtype].push(item);\n            });\n            return _data;\n        },\n        isLogin() {\n            return User.isLogin();\n        },\n    },\n    watch: {\n        isLogin: {\n            immediate: true,\n            handler: function (val) {\n                val &&\n                    User.getAsset().then((res) => {\n                        this.points = res?.points || 0;\n                    });\n            },\n        },\n    },\n    mounted() {\n        this.init();\n    },\n    methods: {\n        // 初始化，获取活动ID,并获取活动详情\n        init() {\n            getTopic(KEY).then((res) => {\n                this.raw = res.data.data;\n                this.ID = ~~this.data.ID[0].title;\n                this.ID &&\n                    getBlindBox(this.ID).then((res) => {\n                        const data = res.data.data;\n                        const asset = {\n                            point: `${this.__imgRoot}points.png`,\n                            boxcoin: `${this.__imgRoot}boxcoin.png`,\n                        };\n                        this.prizeList = data.prize.map((item) => {\n                            if (item.prize_type != \"mall_goods\" && asset[item.vip_asset_type])\n                                return asset[item.vip_asset_type];\n                            return item.mall_goods.goods_images[0];\n                        });\n                        this.refreshBox();\n                    });\n                this.ID &&\n                    getMyHistory({ luckyDrawId: this.ID, pageSize: this.pageSize }).then((res) => {\n                        this.historyList = res.data.data;\n                    });\n            });\n        },\n        showBox(index) {\n            return this.activeList.includes(index + 1);\n        },\n        // 刷新box\n        refreshBox() {\n            this.allActive = false;\n            this.activeList = cloneDeep(this.boxList);\n            this.replay++;\n        },\n        onLoadPrizeList() {\n            // 根据给的奖品参数计算动画时间两份图只滚动一份，所以/100再/2\n            this.animationDuration = `${this.$refs.scrollBlock.offsetWidth / 60}s`;\n        },\n        change(number) {\n            this.active = number;\n            setTimeout(() => {\n                this.activeList = this.activeList.filter((item) => item !== number);\n                this.show_goods = true;\n            }, 1800);\n        },\n        openHistory() {\n            this.history = true;\n            this.close = false;\n        },\n        closeHistory() {\n            this.history = false;\n            this.close = true;\n        },\n        openBox(key) {\n            if (key === \"all\") {\n                this.allActive = true;\n                setTimeout(() => {\n                    this.activeList = [];\n                }, 1800);\n            } else {\n                const number = this.activeList[Math.floor(Math.random() * this.activeList.length)];\n                this.change(number);\n            }\n            this.hasLucky();\n        },\n        toLogin() {\n            this.$confirm(\"参与抽奖必须登录, 是否登录?\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            }).then(() => {\n                User.toLogin();\n            });\n        },\n        hasLucky() {\n            let batch = 1;\n            if (this.allActive) batch = 10;\n            goodLucky(this.ID, { batch }).then((res) => {\n                console.log(res);\n            });\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/blindbox/index.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=0d6a123a&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=0d6a123a&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = lengthOfArrayLike(O);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.es/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n"],"sourceRoot":""}