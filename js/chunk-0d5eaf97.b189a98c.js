(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d5eaf97"],{"0d22":function(t,e,s){},"127f":function(t,e,s){"use strict";s("0d22")},"498a":function(t,e,s){"use strict";var a=s("23e7"),i=s("58a8").trim,n=s("c8d2");a({target:"String",proto:!0,forced:n("trim")},{trim:function(){return i(this)}})},"7ddc":function(t,e,s){"use strict";s("8eb8")},"8eb8":function(t,e,s){},"955d":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-event",class:"v-"+t.page_name},[e("Header",{attrs:{overlayEnable:!0}}),e("div",{staticClass:"p-event-content"},[e("div",{staticClass:"m-top"}),e("Content"),e("div",{staticClass:"m-bottom"},[e("img",{staticClass:"m-man",attrs:{src:t.imgRoot+"man.png"}}),e("img",{staticClass:"m-woman",attrs:{src:t.imgRoot+"woman.png"}})])],1)],1)},i=[],n=(s("b0c0"),s("ac1f"),s("841c"),s("498a"),s("9911"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-content"},[e("div",{staticClass:"m-user-info"},[e("div",{staticClass:"m-name"},[t.isLogin?[e("img",{staticClass:"u-img",attrs:{src:t.userInfo.avatar}}),e("span",{staticClass:"u-name"},[t._v(t._s(t.userInfo.name))])]:t._e()],2),e("div",{staticClass:"m-button"},[e("span",{staticClass:"u-btn u-register",on:{click:t.add}},[t._v("注册铭牌")]),e("span",{staticClass:"u-btn u-mine",on:{click:t.changeList}},[t._v(t._s(t.isMyList?"全部铭牌":"我的铭牌")+" ")])])]),e("div",{staticClass:"m-namespace"},[e("div",{staticClass:"m-tool"},[e("span",{staticClass:"u-title"},[t._v(t._s(t.title))]),e("div",{staticClass:"m-search"},[e("div",{staticClass:"m-tabs"},t._l(t.tabs,(function(s,a){return e("span",{key:a,class:[{active:t.type==s.value},"u-tab"],on:{click:function(e){return t.change(s.value)}}},[t._v(t._s(s.label))])})),0),e("div",{key:"namespace-search",staticClass:"u-search",attrs:{slot:"search-before"},slot:"search-before"},[e("el-input",{staticClass:"u-input",attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:t.onSearch},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.onSearch},slot:"append"})],1)],1)])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-list",class:{isMyList:t.isMyList}},[t.list.length?t._l(t.list,(function(s,a){return e("div",{key:a,staticClass:"m-item"},[e("a",{staticClass:"m-title",attrs:{target:"_blank",href:s.link}},[e("div",{staticClass:"u-title"},[e("i",{staticClass:"el-icon-postcard"}),e("span",[t._v(t._s(s.key))])]),e("span",{staticClass:"u-tag"},[t._v("剑网3.com/"+t._s(s.key))])]),e("a",{staticClass:"u-desc",attrs:{target:"_blank",href:s.link}},[t._v(t._s(s.desc))]),e("div",{staticClass:"m-info"},[s.user?e("span",{staticClass:"u-name"},[e("i",{staticClass:"el-icon-user"}),t._v(t._s(s.user.display_name)+" ")]):t._e(),e("span",[e("i",{staticClass:"el-icon-date"}),t._v(t._s(t.dataFormat(s.created)))]),e("el-button",{staticClass:"u-edit",attrs:{size:"mini"},on:{click:function(e){return e.stopPropagation(),t.edit(s,a)}}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 编辑")])],1)])})):e("span",{staticClass:"m-item m-no-item"},[t._v(" 暂无对应铭牌 ")])],2),e("div",{staticClass:"m-namespace-pages"},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1)]),e("el-dialog",{attrs:{title:"铭牌注册",visible:t.visible,width:"600","before-close":t.close},on:{"update:visible":function(e){t.visible=e}}},[e("Form",{attrs:{data:t.data},on:{close:t.close,update:t.update}})],1)],1)}),r=[],o=(s("d3b7"),s("d81d"),s("159b"),s("b64b"),s("41cb"));function c(t){return Object(o["a"])().get("/api/cms/namespace",{params:t})}function l(t){return Object(o["b"])()({method:"GET",url:"/api/my/namespaces",params:t})}function u(t,e){return Object(o["a"])().put("/api/cms/namespace/".concat(t),e)}function m(t){return Object(o["a"])().post("/api/cms/namespace",t)}function d(t){return Object(o["a"])().get("/api/cms/namespace-key",{params:{key:t}})}var h=s("85e4"),p=s("c9d2"),f=s("e4f1"),v=s("65c2"),b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-namespace-box"},[e("div",{staticClass:"m-header"},[t._m(0),e("div",{staticClass:"u-count"},[e("span",{staticClass:"u-count-txt"},[t._v(" 当前可建铭牌数： "),e("b",[t._v(t._s(t.count))]),t._v(" 个 ")]),t._m(1)])]),e("el-form",{staticClass:"m-publish-namespace-form",attrs:{rules:t.rules,model:t.form}},[e("el-form-item",{staticClass:"m-input",attrs:{label:"关键词",prop:"key"}},[e("el-input",{attrs:{placeholder:"全局唯一关键词"},model:{value:t.form.key,callback:function(e){t.$set(t.form,"key",e)},expression:"form.key"}}),t.form.key&&!t.available?e("el-alert",{staticClass:"u-available",attrs:{title:"已有关键词，请重新输入",type:"error","show-icon":""}}):t._e()],1),e("el-form-item",{attrs:{label:"链接",prop:"link"}},[e("el-input",{attrs:{placeholder:"请输入跳转地址"},model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}},[e("template",{slot:"prepend"},[t._v("https://")])],2)],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{attrs:{placeholder:"请输入关于铭牌的描述",maxlength:"30","show-word-limit":""},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),e("el-form-item",{attrs:{align:"center"}},[e("el-button",{on:{click:t.close}},[t._v("关闭")]),e("el-button",{staticClass:"u-submit",attrs:{type:"primary",disabled:!t.ready||t.processing},on:{click:t.onSubmit}},[t._v(" 提交 ")])],1)],1)],1)},g=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-tip"},[t._v(' 铭牌是一个可以通过关键词快速访问的功能，例如定义铭牌 "某某气纯宏"，则可以在浏览器地址栏中通过快速输入 '),e("a",{attrs:{href:"https://剑网3.com/某某气纯宏",target:"_blank"}},[e("b",[t._v("剑网3.com/某某气纯宏")])]),t._v(" 访问你输入的链接 ")])},function(){var t=this,e=t._self._c;return e("a",{staticClass:"el-button el-button--primary el-button--mini",attrs:{href:"/vip/namespace?from=dashboard_namespace_create",target:"_blank"}},[e("i",{staticClass:"el-icon-shopping-cart-2"}),t._v(" 购买铭牌 ")])}];s("25f0"),s("caad"),s("2532"),s("5319");function y(t){var e=Object.prototype.toString.call(t);return e.match(/\[object (.*?)\]/)[1].toLowerCase()}var _=y;class k{constructor(t){if("string"!==_(t))throw new Error("[Sterilizer::init] params should be string");this._symbols={"`":"`","~":"~","!":"!","@":"@","#":"#",$:"\\$","%":"%","^":"\\^","&":"&","*":"\\*","-":"\\-",_:"_","=":"=","+":"+","(":"\\(",")":"\\)","[":"\\[","]":"\\]","{":"\\{","}":"\\}","|":"\\|","\\":"\\\\","/":"/","?":"\\?",":":":",";":";","'":"'",'"':'"',">":">","<":"<",",":",",".":"\\."},this.symbols=Object.keys(this._symbols),this.regs=Object.values(this._symbols),this.str=t,this._str=t}toString(){return this._str}_detected(t){let e=_(t),s=["string","array","set"];if(!s.includes(e))throw new Error("[Sterilizer::remove] params should be string|array|set");return t}_sterilize(t){t=[...t].join("");let e=new RegExp(`[${t}]`,"gm");return this._str=this._str.replace(e,""),this}kill(t){let e=null;if(void 0==t)e=new Set(this.regs);else{this._detected(t),e=new Set;let s=new Set(t);for(let t of s)this.symbols.includes(t)&&e.add(this._symbols[t])}return this._sterilize(e)}live(t){this._detected(t);let e=new Set(this.regs);for(let s of t)this.symbols.includes(s)&&e.delete(this._symbols[s]);return this._sterilize(e)}safe(){return this.kill(["&","<",">",'"',"'","+",":","/","?","=","#","%"])}removeHSC(){return this.kill(["&","<",">",'"',"'"])}removeURL(){return this.kill(["+",":","/","?","=","&","#","%"])}removeSpace(){return this._str=this._str.replace(/\s/gm,""),this}remove(t,e){let s=new RegExp(""+t,"gm");return e=void 0!==e?e:"",this._str=this._str.replace(s,e),this}removeHTMLtag(){return this._str=this._str.replace(/<[^>]+>/gm,""),this}isDirty(t){return t?this.str.includes(t):this.symbols.some(t=>this.str.includes(t))}}function C(t){return new k(t)}var w={name:"namespace",props:["data"],data:function(){return{count:0,available:!1,processing:!1,form:{},rules:{key:[{required:!0,message:"请输入铭牌名称",trigger:"blur"}],link:[{required:!0,message:"请输入链接网址",trigger:"blur"}]}}},computed:{isEditMode:function(){return"edit"==this.data.mode},params:function(){return{key:this.form.key,desc:this.form.desc,link:"https://"+this.form.link,source_type:"custom"}},ready:function(){return this.isEditMode?this.available&&this.form.link:this.available&&this.form.link&&this.count}},watch:{"data.form":{immediate:!0,handler:function(t){this.form=t}},"form.key":function(t){this.checkKey(t)},"form.link":function(t){this.checkLink(t)}},methods:{close:function(){this.$emit("close")},checkKey:function(t){t?(this.form.key=C(this.form.key).kill().removeSpace().toString(),this.form.key!=this.key_cache?this.checkAvailable():this.available=!0):this.available=!0},checkLink:function(t){if(t){var e=this.form.link;(e.includes("http://")||e.includes("https://"))&&(this.form.link=e.replace(/https?\:\/\//,""))}},checkAvailable:function(){var t=this;d(this.form.key).then((function(e){e.data.data?t.available=!1:t.available=!0}))},onSubmit:function(){var t=this;if(""==this.form.desc){var e=p["a"].getInfo();this.params.desc=e.name+"创建"}this.processing=!0,this.isEditMode?u(this.form.ID,this.params).then((function(){t.form.__index=t.data.index,t.onSuccess()})).finally((function(){t.processing=!1})):m(this.params).then((function(e){t.form.user={display_name:""},t.onSuccess(),t.count-=1})).finally((function(){t.processing=!1}))},onSuccess:function(){this.$notify.success({title:"成功",message:"提交成功",showClose:!1}),this.close(),this.$emit("update",this.form)}},created:function(){var t=this;p["a"].getAsset().then((function(e){t.count=e.namespace_card_count}))}},S=w,L=(s("7ddc"),s("2877")),x=Object(L["a"])(S,b,g,!1,null,null,null),O=x.exports,j=s("2ef0"),M={name:"Content",data:function(){return{type:"all",tabs:[{label:"全部",value:"all"},{label:"玩家",value:"player"},{label:"团队",value:"team"},{label:"系统",value:"system"},{label:"自定义",value:"custom"}],list:"",per:8,total:1,page:1,search:"",query:"",loading:!1,isLogin:p["a"].isLogin(),userInfo:p["a"].getInfo(),isMyList:!1,visible:!1,form:{key:"",desc:"",link:""},data:{}}},components:{Form:O},computed:{register_link:function(){return Object(h["publishLink"])("namespace")},params:function(){var t={source_type:"all"==this.type?"":this.type,page:this.page,per:this.per,status:1};return t},title:function(){return this.isMyList?"我的铭牌":"铭牌大厅"}},watch:{type:function(){this.page=1},params:{deep:!0,immediate:!0,handler:function(t){this.query="",this.isMyList?this.loadMyData():this.loadData()}},"$route.query":{deep:!0,immediate:!0,handler:function(t){var e=this;t.namespace&&(this.search=t.namespace,setTimeout((function(){e.onSearch()}),1e3))}}},methods:{change:function(t){this.type=t},loadData:function(){var t=this;this.loading=!0;var e=this.removeEmpty(Object.assign({},this.params,{key:this.search}));c(e).then((function(e){t.list=e.data.data.list||[],t.total=e.data.data.total})).finally((function(){t.loading=!1}))},loadMyData:function(){var t=this;this.loading=!0;var e=this.params,s=e.source_type,a=e.page,i=e.per,n=e.status,r=this.removeEmpty({key:this.search,source_type:s,page:a,limit:i,status:n});l(r).then((function(e){var s=e.data.data.data||[];t.list=s.map((function(t){return t.user.display_name=t.user.nickname,t})),t.total=e.data.data.total})).finally((function(){t.loading=!1}))},removeEmpty:function(t){return Object.keys(t).forEach((function(e){null!==t[e]&&void 0!==t[e]&&""!==t[e]||delete t[e]})),t},onSearch:function(){if(1!=this.page)return this.page=1;this.loadData()},dataFormat:function(t){return t&&Object(f["a"])(1e3*~~t)||"-"},changeList:function(){this.isLogin&&(this.isMyList=!this.isMyList,this.isMyList?this.loadMyData():this.loadData())},close:function(){this.visible=!1},add:function(){this.visible=!0,this.data={mode:"add",form:Object(j["cloneDeep"])(this.form)}},edit:function(t,e){this.visible=!0,this.data={mode:"edit",form:Object(j["cloneDeep"])(t),index:e}},update:function(t){t.ID?this.list[t.__index]=t:this.isMyList&&this.loadMyData()}},created:function(){this.query=this.$route.query.namespace}},E=M,D=(s("127f"),Object(L["a"])(E,n,r,!1,null,null,null)),$=D.exports,I=s("9616"),R={name:"Index",components:{Content:$},data:function(){return{imgRoot:v["__imgPath"]+"topic/namespace/"}},computed:{page_name:function(){return"namespace"}},created:function(){Object(I["b"])("event","namespace")}},q=R,z=Object(L["a"])(q,a,i,!1,null,null,null);e["default"]=z.exports},c8d2:function(t,e,s){var a=s("5e77").PROPER,i=s("d039"),n=s("5899"),r="​᠎";t.exports=function(t){return i((function(){return!!n[t]()||r[t]()!==r||a&&n[t].name!==t}))}}}]);
//# sourceMappingURL=chunk-0d5eaf97.b189a98c.js.map