(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a0fbcf6"],{"0d76":function(t,i,s){"use strict";s.d(i,"a",(function(){return n}));var o=s("41cb");function n(t){return Object(o["a"])({mute:!0}).get("/api/cms/topic",{params:{type:t,all:1,status:1}})}},"10d6":function(t,i,s){"use strict";s("5f11")},"5f11":function(t,i,s){},"759a":function(t,i,s){"use strict";s.r(i);var o=function(){var t=this,i=t._self._c;return i("div",{staticClass:"p-event-blindbox"},[t.isLogin?t._e():i("div",{staticClass:"m-mark",on:{click:t.toLogin}}),i("el-image",{staticClass:"m-bg",attrs:{src:"".concat(t.__imgRoot,"bg.png"),fit:"cover"}}),i("div",{staticClass:"p-event-content"},[i("div",{staticClass:"m-content"},[i("div",{staticClass:"m-left"},[i("div",{staticClass:"logo"},[i("img",{attrs:{src:"".concat(t.__imgRoot,"logo.png"),alt:"魔盒盲盒"}})]),i("div",{staticClass:"m-box",class:{active:t.allActive}},[t._l(t.boxList,(function(s,o){return i("div",{key:o,class:["u-box","",{active:s===t.active}],on:{click:function(i){return t.change(s)}}},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.showBox(o),expression:"showBox(index)"}],key:t.replay+"box"+o,class:"u-img u-img-".concat(o+1),attrs:{src:"".concat(t.__imgRoot,"box.png"),alt:"奖品"}})])})),i("div",{class:["u-mark",{active:t.active}]})],2)]),i("div",{staticClass:"m-right"},[i("div",{staticClass:"m-point"},[t._v(t._s(t.points))]),i("div",{staticClass:"m-prize box"},[i("div",{staticClass:"m-title"},[i("img",{attrs:{src:"".concat(t.__imgRoot,"prize.png"),alt:"奖品一览"}})]),i("div",{staticClass:"m-item"},[i("div",{ref:"scrollBlock",staticClass:"m-scroll-block",style:{animationDuration:t.animationDuration}},[t._l(t.prizeList,(function(s,o){return i("img",{key:"prize".concat(o),attrs:{src:s},on:{load:t.onLoadPrizeList}})})),t._l(t.prizeList,(function(s,o){return i("img",{key:"prize_end".concat(o),attrs:{src:s},on:{load:t.onLoadPrizeList}})}))],2)])]),i("div",{staticClass:"m-lottery"},[i("img",{staticClass:"u-img refresh",attrs:{src:"".concat(t.__imgRoot,"refresh.png"),alt:"刷新盲盒"},on:{click:t.refreshBox}}),i("img",{staticClass:"u-img random",attrs:{src:"".concat(t.__imgRoot,"random.png"),alt:"随机开盒"},on:{click:t.openBox}}),i("img",{staticClass:"u-img open",attrs:{src:"".concat(t.__imgRoot,"open.png"),alt:"十连开盒"},on:{click:function(i){return t.openBox("all")}}}),i("div",{staticClass:"m-history box u-img",class:{history:t.history,close:t.close}},[i("div",{staticClass:"m-title"},[i("img",{attrs:{src:"".concat(t.__imgRoot,"history.png"),alt:"开盒记录"},on:{click:t.openHistory}}),i("img",{staticClass:"u-close",attrs:{src:"".concat(t.__imgRoot,"close.png"),alt:"关闭"},on:{click:t.closeHistory}})]),i("div",{staticClass:"m-history-content"},t._l(t.historyList,(function(s,o){return i("div",{key:o,staticClass:"m-item"},[t._v(" "+t._s(s)+" ")])})),0)])])])])])],1)},n=[],a=(s("d81d"),s("cb29"),s("d3b7"),s("159b"),s("14d9"),s("caad"),s("2532"),s("4de4"),s("c9d2")),c=s("0d76"),e=s("41cb");function r(t){return Object(e["d"])().get("/lucky-draw/my/history",{params:t})}function l(t){return Object(e["d"])().get("/lucky-draw/public/details",{params:{id:t}})}function u(t,i){return Object(e["d"])().post("/lucky-draw/public/item/".concat(t,"/try-my-lucky"),i)}var d=s("2ef0"),m="blindbox",h={name:"Index",inject:["__imgRoot"],data:function(){return{ID:0,prizeList:[],points:0,index:0,animationDuration:"0s",active:"",allActive:!1,boxList:new Array(10).fill(1).map((function(t,i){return i+1})),activeList:[],replay:0,historyList:[],status:{0:"全部",1:"抽奖中",2:"中奖",3:"未中奖"},history:!1,pageSize:30,close:!1,open:!1,show_goods:!1}},computed:{data:function(){var t={};return this.raw.forEach((function(i){t[i.subtype]||(t[i.subtype]=[]),t[i.subtype].push(i)})),t},isLogin:function(){return a["a"].isLogin()}},watch:{isLogin:{immediate:!0,handler:function(t){var i=this;t&&a["a"].getAsset().then((function(t){i.points=(null===t||void 0===t?void 0:t.points)||0}))}}},mounted:function(){this.init()},methods:{init:function(){var t=this;Object(c["a"])(m).then((function(i){t.raw=i.data.data,t.ID=~~t.data.ID[0].title,t.ID&&l(t.ID).then((function(i){var s=i.data.data,o={point:"".concat(t.__imgRoot,"points.png"),boxcoin:"".concat(t.__imgRoot,"boxcoin.png")};t.prizeList=s.prize.map((function(t){return"mall_goods"!=t.prize_type&&o[t.vip_asset_type]?o[t.vip_asset_type]:t.mall_goods.goods_images[0]})),t.refreshBox()})),t.ID&&r({luckyDrawId:t.ID,pageSize:t.pageSize}).then((function(i){t.historyList=i.data.data}))}))},showBox:function(t){return this.activeList.includes(t+1)},refreshBox:function(){this.allActive=!1,this.activeList=Object(d["cloneDeep"])(this.boxList),this.replay++},onLoadPrizeList:function(){this.animationDuration="".concat(this.$refs.scrollBlock.offsetWidth/60,"s")},change:function(t){var i=this;this.active=t,setTimeout((function(){i.activeList=i.activeList.filter((function(i){return i!==t})),i.show_goods=!0}),1800)},openHistory:function(){this.history=!0,this.close=!1},closeHistory:function(){this.history=!1,this.close=!0},openBox:function(t){var i=this;if("all"===t)this.allActive=!0,setTimeout((function(){i.activeList=[]}),1800);else{var s=this.activeList[Math.floor(Math.random()*this.activeList.length)];this.change(s)}this.hasLucky()},toLogin:function(){this.$confirm("参与抽奖必须登录, 是否登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a["a"].toLogin()}))},hasLucky:function(){var t=1;this.allActive&&(t=10),u(this.ID,{batch:t}).then((function(t){console.log(t)}))}}},p=h,f=(s("10d6"),s("2877")),g=Object(f["a"])(p,o,n,!1,null,null,null);i["default"]=g.exports},"81d5":function(t,i,s){"use strict";var o=s("7b0b"),n=s("23cb"),a=s("07fa");t.exports=function(t){var i=o(this),s=a(i),c=arguments.length,e=n(c>1?arguments[1]:void 0,s),r=c>2?arguments[2]:void 0,l=void 0===r?s:n(r,s);while(l>e)i[e++]=t;return i}},cb29:function(t,i,s){"use strict";var o=s("23e7"),n=s("81d5"),a=s("44d2");o({target:"Array",proto:!0},{fill:n}),a("fill")}}]);
//# sourceMappingURL=chunk-4a0fbcf6.88b6e9f7.js.map