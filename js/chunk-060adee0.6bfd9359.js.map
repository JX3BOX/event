{"version":3,"sources":["webpack:///./src/service/topic.js","webpack:///./src/pages/blindbox/Index.vue?a4bc","webpack:///./src/pages/blindbox/Index.vue","webpack:///./src/service/pay.js","webpack:///src/pages/blindbox/Index.vue","webpack:///./src/pages/blindbox/Index.vue?a447","webpack:///./src/pages/blindbox/Index.vue?a8d6"],"names":["getTopic","topic","$cms","mute","get","params","type","all","status","render","_vm","this","_c","_self","staticClass","attrs","concat","__imgRoot","_l","item","index","key","class","active","on","$event","change","directives","name","rawName","value","showBox","expression","replay","_v","_s","points","ref","style","animationDuration","prizeList","url","onLoadPrizeList","refreshBox","history","close","openHistory","closeHistory","show_goods","staticRenderFns","getBlindBox","id","$pay","KEY","inject","data","ID","isLogin","User","open","activeList","computed","_data","raw","forEach","subtype","push","Asset","getAsset","console","log","mounted","init","methods","_this","then","res","title","prize","includes","$refs","scrollBlock","offsetWidth","_this2","setTimeout","component"],"mappings":"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","file":"js/chunk-060adee0.6bfd9359.js","sourcesContent":["import { $cms } from \"@jx3box/jx3box-common/js/https\";\n\nfunction getTopic(topic) {\n    return $cms({ mute: true }).get(\"/api/cms/topic\", {\n        params: {\n            type: topic,\n            all: 1,\n            status: 1,\n        },\n    });\n}\n\nexport { getTopic };","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=style&index=0&id=2d49c000&prod&lang=less&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"p-event-blindbox\"},[_c('el-image',{staticClass:\"m-bg\",attrs:{\"src\":`${_vm.__imgRoot}bg.png`,\"fit\":\"cover\"}}),_c('div',{staticClass:\"p-event-content\"},[_c('div',{staticClass:\"m-content\"},[_c('div',{staticClass:\"m-left\"},[_c('div',{staticClass:\"logo\"},[_c('img',{attrs:{\"src\":`${_vm.__imgRoot}logo.png`,\"alt\":\"魔盒盲盒\"}})]),_c('div',{staticClass:\"m-box\"},[_vm._l((10),function(item,index){return _c('div',{key:item,class:['u-box', { active: index === _vm.active }],on:{\"click\":function($event){return _vm.change(index)}}},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showBox(index)),expression:\"showBox(index)\"}],key:_vm.replay + 'box' + index,class:`u-img u-img-${index + 1}`,attrs:{\"src\":`${_vm.__imgRoot}box.png`,\"alt\":\"奖品\"}})])}),_c('div',{class:['u-mark', { active: _vm.active }]})],2)]),_c('div',{staticClass:\"m-right\"},[_c('div',{staticClass:\"m-point\"},[_vm._v(_vm._s(_vm.points))]),_c('div',{staticClass:\"m-prize box\"},[_c('div',{staticClass:\"m-title\"},[_c('img',{attrs:{\"src\":`${_vm.__imgRoot}prize.png`,\"alt\":\"奖品一览\"}})]),_c('div',{staticClass:\"m-item\"},[_c('div',{ref:\"scrollBlock\",staticClass:\"m-scroll-block\",style:({ animationDuration: _vm.animationDuration })},[_vm._l((_vm.prizeList),function(item,index){return _c('img',{key:`prize${index}`,attrs:{\"src\":item.url,\"alt\":item.name},on:{\"load\":_vm.onLoadPrizeList}})}),_vm._l((_vm.prizeList),function(item,index){return _c('img',{key:`prize_end${index}`,attrs:{\"src\":item.url,\"alt\":item.name},on:{\"load\":_vm.onLoadPrizeList}})})],2)])]),_c('div',{staticClass:\"m-lottery\"},[_c('img',{staticClass:\"u-img refresh\",attrs:{\"src\":`${_vm.__imgRoot}refresh.png`,\"alt\":\"刷新盲盒\"},on:{\"click\":_vm.refreshBox}}),_c('img',{staticClass:\"u-img random\",attrs:{\"src\":`${_vm.__imgRoot}random.png`,\"alt\":\"随机开盒\"}}),_c('img',{staticClass:\"u-img open\",attrs:{\"src\":`${_vm.__imgRoot}open.png`,\"alt\":\"十连开盒\"}}),_c('div',{staticClass:\"m-history box u-img\",class:{ history: _vm.history, close: _vm.close }},[_c('div',{staticClass:\"m-title\"},[_c('img',{attrs:{\"src\":`${_vm.__imgRoot}history.png`,\"alt\":\"开盒记录\"},on:{\"click\":_vm.openHistory}}),_c('img',{staticClass:\"u-close\",attrs:{\"src\":`${_vm.__imgRoot}close.png`,\"alt\":\"关闭\"},on:{\"click\":_vm.closeHistory}})]),_c('div',{staticClass:\"m-history-content\"})])])])])]),_c('div',{staticClass:\"m-goods\",class:{ active: _vm.show_goods }},[_c('div',{staticClass:\"m-item\"},_vm._l((10),function(item){return _c('div',{key:item,staticClass:\"u-item box\"})}),0),_c('img',{staticClass:\"u-get\",attrs:{\"src\":`${_vm.__imgRoot}get.png`,\"alt\":\"拿下\"},on:{\"click\":function($event){_vm.show_goods = false}}})])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $pay } from \"@jx3box/jx3box-common/js/https\";\n\n\n// 获取中奖历史\nfunction getMyHistory(params) {\n    return $pay().get(`/lucky-draw/my/history`, { params });\n}\n\n// 所有抽奖列表\nfunction getLuckyList(params) {\n    return $pay().get(`/lucky-draw/public/list`, { params });\n}\n\n// 获取活动详情\nfunction getBlindBox(id) {\n    return $pay().get(`/lucky-draw/public/details`, { params:{id} });\n}\n\n// 抽奖\nfunction goodLucky(id, data) {\n    return $pay().post(`/lucky-draw/public/item/${id}/try-my-lucky`, data);\n}\n\n\nexport {\n    getMyHistory,\n    getBlindBox,\n    goodLucky,\n    getLuckyList\n};","<template>\n    <div class=\"p-event-blindbox\">\n        <el-image :src=\"`${__imgRoot}bg.png`\" class=\"m-bg\" fit=\"cover\" />\n        <div class=\"p-event-content\">\n            <div class=\"m-content\">\n                <div class=\"m-left\">\n                    <div class=\"logo\">\n                        <img :src=\"`${__imgRoot}logo.png`\" alt=\"魔盒盲盒\" />\n                    </div>\n                    <div class=\"m-box\">\n                        <div\n                            :class=\"['u-box', { active: index === active }]\"\n                            v-for=\"(item, index) in 10\"\n                            :key=\"item\"\n                            @click=\"change(index)\"\n                        >\n                            <img\n                                :class=\"`u-img u-img-${index + 1}`\"\n                                :src=\"`${__imgRoot}box.png`\"\n                                alt=\"奖品\"\n                                :key=\"replay + 'box' + index\"\n                                v-show=\"showBox(index)\"\n                            />\n                        </div>\n                        <div :class=\"['u-mark', { active }]\"></div>\n                    </div>\n                </div>\n                <div class=\"m-right\">\n                    <div class=\"m-point\">{{ points }}</div>\n                    <div class=\"m-prize box\">\n                        <div class=\"m-title\">\n                            <img :src=\"`${__imgRoot}prize.png`\" alt=\"奖品一览\" />\n                        </div>\n                        <div class=\"m-item\">\n                            <div class=\"m-scroll-block\" ref=\"scrollBlock\" :style=\"{ animationDuration }\">\n                                <img\n                                    v-for=\"(item, index) in prizeList\"\n                                    :key=\"`prize${index}`\"\n                                    @load=\"onLoadPrizeList\"\n                                    :src=\"item.url\"\n                                    :alt=\"item.name\"\n                                />\n                                <img\n                                    v-for=\"(item, index) in prizeList\"\n                                    :key=\"`prize_end${index}`\"\n                                    @load=\"onLoadPrizeList\"\n                                    :src=\"item.url\"\n                                    :alt=\"item.name\"\n                                />\n                                <!--跑马灯效果需要展示两份图片以首尾衔接-->\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"m-lottery\">\n                        <img\n                            :src=\"`${__imgRoot}refresh.png`\"\n                            class=\"u-img refresh\"\n                            @click=\"refreshBox\"\n                            alt=\"刷新盲盒\"\n                        />\n                        <img :src=\"`${__imgRoot}random.png`\" class=\"u-img random\" alt=\"随机开盒\" />\n                        <img :src=\"`${__imgRoot}open.png`\" class=\"u-img open\" alt=\"十连开盒\" />\n                        <div class=\"m-history box u-img\" :class=\"{ history, close }\">\n                            <div class=\"m-title\">\n                                <img :src=\"`${__imgRoot}history.png`\" alt=\"开盒记录\" @click=\"openHistory\" />\n                                <img :src=\"`${__imgRoot}close.png`\" class=\"u-close\" alt=\"关闭\" @click=\"closeHistory\" />\n                            </div>\n                            <div class=\"m-history-content\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"m-goods\" :class=\"{ active: show_goods }\">\n            <div class=\"m-item\">\n                <div class=\"u-item box\" v-for=\"item in 10\" :key=\"item\"></div>\n            </div>\n            <img :src=\"`${__imgRoot}get.png`\" class=\"u-get\" alt=\"拿下\" @click=\"show_goods = false\" />\n        </div>\n    </div>\n</template>\n\n<script>\nconst KEY = \"blindbox\";\nimport { getTopic } from \"@/service/topic\";\nimport { getBlindBox } from \"@/service/pay\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nexport default {\n    name: \"Index\",\n    inject: [\"__imgRoot\"],\n    data: function () {\n        return {\n            ID: 0,\n            isLogin: User.isLogin(),\n            prizeList: [],\n\n            history: false,\n            close: false,\n            open: false,\n            all: false,\n            show_goods: false,\n            active: \"\",\n            replay: 0,\n            activeList: [],\n\n            animationDuration: \"0s\",\n        };\n    },\n    computed: {\n        data: function () {\n            let _data = {};\n            this.raw.forEach((item) => {\n                if (!_data[item.subtype]) _data[item.subtype] = [];\n                _data[item.subtype].push(item);\n            });\n            return _data;\n        },\n        Asset() {\n            return User.getAsset();\n        },\n        points() {\n            console.log(this.Asset);\n            return this.isLogin ? 0 : \"请登录\";\n        },\n    },\n    mounted() {\n        this.init();\n    },\n    methods: {\n        init() {\n            getTopic(KEY).then((res) => {\n                this.raw = res.data.data;\n                this.ID = ~~this.data.ID[0].title;\n                this.ID &&\n                    getBlindBox(this.ID).then((res) => {\n                        const data = res.data.data;\n                        console.log(data);\n                        this.prizeList = data.prize;\n                    });\n            });\n        },\n        showBox(index) {\n            return !this.activeList.includes(index);\n        },\n        refreshBox() {\n            this.activeList = [];\n            this.replay++;\n        },\n        onLoadPrizeList() {\n            // 根据给的奖品参数计算动画时间两份图只滚动一份，所以/100再/2\n            this.animationDuration = `${this.$refs.scrollBlock.offsetWidth / 200}s`;\n        },\n        change(index) {\n            this.active = ~~index;\n            setTimeout(() => {\n                this.activeList.push(~~index);\n                this.show_goods = true;\n                this.active = \"\";\n            }, 1800);\n        },\n        openHistory() {\n            this.history = true;\n            this.close = false;\n        },\n        closeHistory() {\n            this.history = false;\n            this.close = true;\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/blindbox/index.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=2d49c000&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=2d49c000&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}